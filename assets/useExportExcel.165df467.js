var E=Object.defineProperty;var D=(e,n,o)=>n in e?E(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o;var a=(e,n,o)=>(D(e,typeof n!="symbol"?n+"":n,o),o);import{F as A}from"./FileSaver.min.0804dd93.js";import{w as k,u as x,S as _}from"./xlsx.5331d5b0.js";import"./vendor.e853b41c.js";function C(e){console.log(e);const n=[],o=e==null?void 0:e.querySelectorAll("tr"),t=[];for(let c=0;c<o.length;++c){const s=[],f=o[c].querySelectorAll("td");for(let i=0;i<f.length;++i){const w=f[i];let S=w.getAttribute("colspan"),b=w.getAttribute("rowspan"),g=w.innerText;if(typeof g=="number"&&g===Number(g)&&(g=Number(g)),t.forEach(l=>{if(c>=l.s.r&&c<=l.e.r&&s.length>=l.s.c&&s.length<=l.e.c)for(let y=0;y<=l.e.c-l.s.c;++y)s.push(null)}),(b||S)&&(b=b||1,S=S||1,t.push({s:{r:c,c:s.length},e:{r:c+b-1,c:s.length+S-1}})),s.push(g!==""?g:null),S)for(let l=0;l<S-1;++l)s.push(null)}n.push(s)}return[n,t]}function B(e,n){return n&&(e=Number(e)+1462),(Date.parse(String(e))-Date.parse(String(new Date(Date.UTC(1899,11,30)))))/(24*60*60*1e3)}function T(e,n){const o={},t={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(let c=0;c!==e.length;++c)for(let s=0;s!==e[c].length;++s){t.s.r>c&&(t.s.r=c),t.s.c>s&&(t.s.c=s),t.e.r<c&&(t.e.r=c),t.e.c<s&&(t.e.c=s);const r={v:e[c][s]};if(r.v!==null){const f=x.encode_cell({c:s,r:c});if(typeof r.v=="number")r.t="n";else if(typeof r.v=="boolean")r.t="b";else if(r.v instanceof Date){r.t="n";const i=_.parse_date_code(14);r.z=i,r.v=B(r.v)}else r.t="s";o[f]=r}}return t.s.c<1e7&&(o["!ref"]=x.encode_range(t)),o}class v{constructor(n=[],o={}){a(this,"SheetNames");a(this,"Sheets");this.SheetNames=n,this.Sheets=o}}function N(e){const n=new ArrayBuffer(e.length),o=new Uint8Array(n);for(let t=0;t!==e.length;++t)o[t]=e.charCodeAt(t)&255;return n}function F(e){const n=document.getElementById(e),o=C(n),t=o[1],c=o[0],s="SheetJS",r=new v,f=T(c);f["!merges"]=t,r.SheetNames.push(s),r.Sheets[s]=f;const i=k(r,{bookType:"xlsx",bookSST:!1,type:"binary"});A.exports.saveAs(new Blob([N(i)],{type:"application/octet-stream"}),"test.xlsx")}function R(e){var b,g,l,y,m;const n=(b=e==null?void 0:e.filename)!=null?b:"defaultExcel",o=(g=e==null?void 0:e.bookType)!=null?g:"xlsx",t=(l=e==null?void 0:e.multiHeader)!=null?l:[],c=(y=e==null?void 0:e.merges)!=null?y:[],s=(m=e.autoWidth)!=null?m:!0,r=[...e.data];r.unshift(e.header);for(let h=t.length-1;h>-1;h--)r.unshift(t[h]);const f="SheetJS",i=new v,w=T(r);if(c.length>0&&(w["!merges"]||(w["!merges"]=[]),c.forEach(h=>{w["!merges"].push(x.decode_range(h))})),s){const h=r.map(p=>p.map(u=>u==null?{wch:10}:u.toString().charCodeAt(0)>255?{wch:u.toString().length*2}:{wch:u.toString().length})),d=h[0];for(let p=1;p<h.length;p++)for(let u=0;u<h[p].length;u++)d[u].wch<h[p][u].wch&&(d[u].wch=h[p][u].wch);w["!cols"]=d}i.SheetNames.push(f),i.Sheets[f]=w;const S=k(i,{bookType:o,bookSST:!1,type:"binary"});A.exports.saveAs(new Blob([N(S)],{type:"application/octet-stream"}),`${n}.${o}`)}var H={exportTableToExcel:F,exportJsonToExcel:R};export{H as default,R as exportJsonToExcel,F as exportTableToExcel};
