var E=Object.defineProperty;var D=(e,n,t)=>n in e?E(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var d=(e,n,t)=>(D(e,typeof n!="symbol"?n+"":n,t),t);import{F as A}from"./FileSaver.min.0804dd93.js";import{w as k,u as x,S as _}from"./xlsx.5331d5b0.js";import"./vendor.e853b41c.js";function C(e){const n=[],t=e==null?void 0:e.querySelectorAll("tr"),c=[];for(let s=0;s<t.length;++s){const o=[],u=t[s].querySelectorAll("td");for(let w=0;w<u.length;++w){const g=u[w];let S=g.getAttribute("colspan"),b=g.getAttribute("rowspan"),f=g.innerText;if(typeof f=="number"&&f===Number(f)&&(f=Number(f)),c.forEach(r=>{if(s>=r.s.r&&s<=r.e.r&&o.length>=r.s.c&&o.length<=r.e.c)for(let p=0;p<=r.e.c-r.s.c;++p)o.push(null)}),(b||S)&&(b=b||1,S=S||1,c.push({s:{r:s,c:o.length},e:{r:s+b-1,c:o.length+S-1}})),o.push(f!==""?f:null),S)for(let r=0;r<S-1;++r)o.push(null)}n.push(o)}return[n,c]}function B(e,n){return n&&(e=Number(e)+1462),(Date.parse(String(e))-Date.parse(String(new Date(Date.UTC(1899,11,30)))))/(24*60*60*1e3)}function T(e){const n={},t={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(let c=0;c!==e.length;++c)for(let s=0;s!==e[c].length;++s){t.s.r>c&&(t.s.r=c),t.s.c>s&&(t.s.c=s),t.e.r<c&&(t.e.r=c),t.e.c<s&&(t.e.c=s);const o={v:e[c][s]};if(o.v!==null){const l=x.encode_cell({c:s,r:c});if(typeof o.v=="number")o.t="n";else if(typeof o.v=="boolean")o.t="b";else if(o.v instanceof Date){o.t="n";const u=_.parse_date_code(14);o.z=u,o.v=B(o.v)}else o.t="s";n[l]=o}}return t.s.c<1e7&&(n["!ref"]=x.encode_range(t)),n}class v{constructor(n=[],t={}){d(this,"SheetNames");d(this,"Sheets");this.SheetNames=n,this.Sheets=t}}function N(e){const n=new ArrayBuffer(e.length),t=new Uint8Array(n);for(let c=0;c!==e.length;++c)t[c]=e.charCodeAt(c)&255;return n}function F(e){const n=document.getElementById(e),t=C(n),c=t[1],s=t[0],o="SheetJS",l=new v,u=T(s);u["!merges"]=c,l.SheetNames.push(o),l.Sheets[o]=u;const w=k(l,{bookType:"xlsx",bookSST:!1,type:"binary"});A.exports.saveAs(new Blob([N(w)],{type:"application/octet-stream"}),"test.xlsx")}function R(e){var b,f,r,p,m;const n=(b=e==null?void 0:e.filename)!=null?b:"defaultExcel",t=(f=e==null?void 0:e.bookType)!=null?f:"xlsx",c=(r=e==null?void 0:e.multiHeader)!=null?r:[],s=(p=e==null?void 0:e.merges)!=null?p:[],o=(m=e.autoWidth)!=null?m:!0,l=[...e.data];l.unshift(e.header);for(let i=c.length-1;i>-1;i--)l.unshift(c[i]);const u="SheetJS",w=new v,g=T(l);if(s.length>0&&(g["!merges"]||(g["!merges"]=[]),s.forEach(i=>{g["!merges"].push(x.decode_range(i))})),o){const i=l.map(y=>y.map(h=>h==null?{wch:10}:h.toString().charCodeAt(0)>255?{wch:h.toString().length*2}:{wch:h.toString().length})),a=i[0];for(let y=1;y<i.length;y++)for(let h=0;h<i[y].length;h++)a[h].wch<i[y][h].wch&&(a[h].wch=i[y][h].wch);g["!cols"]=a}w.SheetNames.push(u),w.Sheets[u]=g;const S=k(w,{bookType:t,bookSST:!1,type:"binary"});A.exports.saveAs(new Blob([N(S)],{type:"application/octet-stream"}),`${n}.${t}`)}var H={exportTableToExcel:F,exportJsonToExcel:R};export{H as default,R as exportJsonToExcel,F as exportTableToExcel};
