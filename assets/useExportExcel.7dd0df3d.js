import{F as e}from"./FileSaver.min.23f7d2dc.js";import{X as t}from"./xlsx.ff224dd7.js";import"./vendor.91abe338.js";import"./___vite-browser-external_commonjs-proxy.a569b36b.js";function n(e,t){t&&(e=Number(e)+1462);return(Date.parse(String(e))-Date.parse(String(new Date(Date.UTC(1899,11,30)))))/864e5}function o(e,o){const r={},l={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(let s=0;s!==e.length;++s)for(let o=0;o!==e[s].length;++o){l.s.r>s&&(l.s.r=s),l.s.c>o&&(l.s.c=o),l.e.r<s&&(l.e.r=s),l.e.c<o&&(l.e.c=o);const c={v:e[s][o]};if(null!==c.v){const e=t.utils.encode_cell({c:o,r:s});if("number"==typeof c.v)c.t="n";else if("boolean"==typeof c.v)c.t="b";else if(c.v instanceof Date){c.t="n";const e=t.SSF.parse_date_code(14);c.z=e,c.v=n(c.v)}else c.t="s";r[e]=c}}return l.s.c<1e7&&(r["!ref"]=t.utils.encode_range(l)),r}class r{constructor(e=[],t={}){this.SheetNames=e,this.Sheets=t}}function l(e){const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let o=0;o!==e.length;++o)n[o]=255&e.charCodeAt(o);return t}function s(n){const s=function(e){console.log(e);const t=[],n=null==e?void 0:e.querySelectorAll("tr"),o=[];for(let r=0;r<n.length;++r){const e=[],l=n[r].querySelectorAll("td");for(let t=0;t<l.length;++t){const n=l[t];let s=n.getAttribute("colspan"),c=n.getAttribute("rowspan"),a=n.innerText;if("number"==typeof a&&a===Number(a)&&(a=Number(a)),o.forEach((t=>{if(r>=t.s.r&&r<=t.e.r&&e.length>=t.s.c&&e.length<=t.e.c)for(let n=0;n<=t.e.c-t.s.c;++n)e.push(null)})),(c||s)&&(c=c||1,s=s||1,o.push({s:{r:r,c:e.length},e:{r:r+c-1,c:e.length+s-1}})),e.push(""!==a?a:null),s)for(let t=0;t<s-1;++t)e.push(null)}t.push(e)}return[t,o]}(document.getElementById(n)),c=s[1],a=s[0],u="SheetJS",i=new r,h=o(a);h["!merges"]=c,i.SheetNames.push(u),i.Sheets.SheetJS=h;const f=t.write(i,{bookType:"xlsx",bookSST:!1,type:"binary"});e.exports.saveAs(new Blob([l(f)],{type:"application/octet-stream"}),"test.xlsx")}function c(n){var s,c,a,u,i;const h=null!=(s=null==n?void 0:n.filename)?s:"defaultExcel",f=null!=(c=null==n?void 0:n.bookType)?c:"xlsx",p=null!=(a=null==n?void 0:n.multiHeader)?a:[],g=null!=(u=null==n?void 0:n.merges)?u:[],m=null==(i=n.autoWidth)||i,S=[...n.data];S.unshift(n.header);for(let e=p.length-1;e>-1;e--)S.unshift(p[e]);const d="SheetJS",b=new r,x=o(S);if(g.length>0&&(x["!merges"]||(x["!merges"]=[]),g.forEach((e=>{x["!merges"].push(t.utils.decode_range(e))}))),m){const e=S.map((e=>e.map((e=>null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length})))),t=e[0];for(let n=1;n<e.length;n++)for(let o=0;o<e[n].length;o++)t[o].wch<e[n][o].wch&&(t[o].wch=e[n][o].wch);x["!cols"]=t}b.SheetNames.push(d),b.Sheets.SheetJS=x;const v=t.write(b,{bookType:f,bookSST:!1,type:"binary"});e.exports.saveAs(new Blob([l(v)],{type:"application/octet-stream"}),`${h}.${f}`)}var a={exportTableToExcel:s,exportJsonToExcel:c};export default a;export{c as exportJsonToExcel,s as exportTableToExcel};
